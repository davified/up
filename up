#!/bin/bash

# Install Xcode Command-Line Tools
if ! xcode-select -p ; then
	xcode-select --install
	exit 0
fi

# Install homebrew
which brew || /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

brew doctor || exit $?

# Install tools
brew install \
	axel \
	diff-so-fancy \
	fish \
	git \
	node \
	python \
	reattach-to-user-namespace \
	ruby \
	stow \
	vim
brew install --HEAD tmux

# Make fish the default shell
if ! grep fish /etc/shells; then
	sudo -s 'echo /usr/local/bin/fish >> /etc/shells'
	chsh -s /usr/local/bin/fish
fi

# Clone dotfiles
[ -d ~/.files ] || git clone https://github.com/spinningarrow/.files ~/.files

# Install dotfiles
pushd ~/.files
ls -d */ | xargs stow
popd

# Create ~/bin
[ -d ~/bin ] || mkdir ~/bin

# Install GUI apps
brew cask install \
	atom \
	dropbox \
	franz \
	google-chrome \
	iterm2 \
	java \
	mplayerx \
	spectacle \
	sublime-text \
	telegram \
	transmission
